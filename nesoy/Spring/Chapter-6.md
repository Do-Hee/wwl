# AOP
- AOP를 바르게 이용하려면?
    - 등장배경과 스프링이 그것을 도입한 이유, 그 적용을 통해 얻을 수 있는 장점이 무엇인지에 대한 충분한 이해가 필요하다.
    - 그래야지만 AOP의 가치를 이해하고 효과적으로 사용할 방법을 찾을 수 있다.

## 6.1 트랜잭션 코드의 분리
- 트랜잭션 경계설정 코드와 비즈니스 코드가 한곳에 있으니 가독성이 떨어진다.
    - 따로 Method를 분리하는 작업을 통해 비즈니스 코드를 쉽게 볼 수 있는 장점이 있다.


- UserService를 인터페이스로 구현하여 비즈니스 로직과 트랜잭션를 두 가지의 관심사를 분리하여 구현한다.
    - 비즈니스 로직만 담당하는 UserServiceImpl
    - 트랜잭션만 관리하는 UserServiceTx

![No Image](/nesoy/Images/Spring/23.png)


## 6.2 고립된 단위 테스트
- 작은 단위의 테스트가 좋은 이유는 테스트가 실패하였을 때 그 원인을 찾기 쉽기 때문
- 비즈니스 로직은 굉장히 심플하지만?
    - 다른 오브젝트와 환경에 의존하고 있다면 작은 테스트 조차 하기 힘든 상황
    - DB가 함께 동작해야 하는 테스트는 작성하기 힘든 경우도 많다.
- 외부에 의존하는 오브젝트를 Mocking 처리한다.
    - 사용자 관리 로직을 검증하는 데 직접적으로 필요하지 않은 의존 오브젝트와 서비스를 모두 제거한 덕분

### 단위 테스트와 통합 테스트
- 단위 테스트
    - 중요한 것은 하나의 단위에 초점을 맞춘 테스트
    - 테스트 대역을 이용해 의존 오브젝트나 외부의 리소스를 사용하지 않도록 고립시켜서 테스트하는 것
- 통합 테스트
    - 두 개 이상의, 성격이나 계층이 다른 오브젝트가 연동하도록 만들어 테스트하거나, 또는 외부의 DB나 파일, 서비스등의 리소스가 참여하는 테스트